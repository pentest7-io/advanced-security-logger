<?php
/**
 * Class WPASL_Bootstrap
 * This class is responsible for dealing with backend views including menu
 */
class WPASL_ViewsHandler
{
    /**
     * Function to register this file into plugin bootstrap
     */
    public static function register()
    {
        // function to load custom plugin assets
        add_action( 'admin_enqueue_scripts', [self::class, "loadScripts"]);

        // function to add plugin menu in wp-admin
        add_action("admin_menu",[self::class, 'drawMenu']);
    }

    /**
     * admin_enqueue_scripts action listener
     */
    public static function loadScripts()
    {
        // Do NOT load it on every admin page, create some logic to only load on your pages
        wp_enqueue_editor();
        // add custom theme css
        wp_enqueue_style( 'wpasl-admin-style', WPASL_PLUGIN_DIR_URL . '/assets/admin/css/style.css', false, '1.0.0' );
        // add custom theme css
        wp_enqueue_style( 'wpasl-pt7-style', '//pentest7.io/wp-pentest7/style.css', false, '1.0.0' );
        // add custom theme css
        wp_enqueue_style( 'wpasl-pt7-font', '//fonts.googleapis.com/css?family=Open+Sans:400', false, '1.0.0' );
        // add custom js
        wp_enqueue_script( 'wpasl-admin-script-pu', '//pentest7.io/wp-pentest7/jquery.bpopup.min.js', ['jquery'], '1.0.0', true);
        // add custom js
        wp_enqueue_script( 'wpasl-admin-script', WPASL_PLUGIN_DIR_URL . '/assets/admin/js/script.js', ['jquery'], '1.0.0', true);
    }

    /**
     * admin_menu action listener
     */
    public static function drawMenu()
    {
        // add main plugin menu
        add_menu_page( 'Advanced Security Logger', 'Advanced Security Logger', 'manage_options', 'wpasl', [self::class, "viewLogs"], '', 10);
        // add sub menu logs
        add_submenu_page('wpasl', 'Logs', 'Logs', 'manage_options', 'wpasl-logs', [self::class, "viewLogs"] );
        // add sub menu settings
        add_submenu_page('wpasl', 'Settings', 'Settings', 'manage_options', 'wpasl-settings', [self::class, "viewSettings"] );
        // remove duplication of main menu
        remove_submenu_page('wpasl','wpasl');
    }

    /**
     * Function to load logs view page
     */
    public static function viewLogs()
    {
        include_once WPASL_PLUGIN_DIR."views/admin/logs.php";
    }

    /**
     * Function to load settings page
     */
    public static function viewSettings()
    {
        include_once WPASL_PLUGIN_DIR."views/admin/settings.php";
    }
}