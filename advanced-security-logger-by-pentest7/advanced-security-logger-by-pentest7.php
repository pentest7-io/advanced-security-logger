<?php
/**
 * Plugin Name: Advanced Security Logger By Pentest7
 * Plugin URI: https://pentest7.io/wordpress-security-plugin.html
 * Description: Advanced security logger designed to protect your wordpress.
 * Author: Pentest7
 * Version: 1.1
 * Author URI: https://pentest7.io
 * Requires at least: 4.8
 * Tested up to: 5.8.1
 * Text Domain: WPASLPT7
 */

// restrict direct access
defined( 'ABSPATH' ) || exit;

// define plugin const path
if ( ! defined( 'WPASL_PLUGIN_DIR' ) ) {
    define( 'WPASL_PLUGIN_DIR', dirname(__FILE__) .'/');
}

if ( ! defined( 'WPASL_PLUGIN_DIR_URL' ) ) {
    define( 'WPASL_PLUGIN_DIR_URL', plugin_dir_url(__FILE__) .'/');
}

if ( ! defined( 'WPASL_DOMAIN' ) ) {
    define( 'WPASL_DOMAIN', 'WPASLPT7');
}

// start loading classes
$classes = scandir(WPASL_PLUGIN_DIR.'classes');
foreach($classes as $class)
{
    if($class == "." || $class == ".."){
        continue;
    }

    include_once WPASL_PLUGIN_DIR.'classes/'.$class;
}

// line below is responsible for entire plugin magic
WPASL_Bootstrap::boot();

// Register database schema
register_activation_hook( __FILE__, [WPASL_DBSchema::class, 'createRequiredTables'] );